<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<div class="product-image-slider-container">
  <div id="product-images--slider">
    {% for image in product.images %}
      <div class="item" data-image-id="{{ image.id }}">
        <img src="{{ image | img_url: 'master' }}" alt="{{ image.alt | escape }}" width="auto" height="auto" />
      </div>
    {% endfor %}
  </div>

  <!-- Round navigation buttons -->
  <div id="product-images--nav" class="slider-nav">
    {% for image in product.images %}
      <div class="nav-item" data-image-id="{{ image.id }}">
        <div class="nav-dot"></div>
      </div>
    {% endfor %}
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

<script>
  // Initialize slick
  var $product_image_slider_obj;

  $product_image_slider_obj = $('#product-images--slider').on('init', function () {
    updateNavigationDots(0);
  }).slick({
    slidesToShow: 1,
    slidesToScroll: 1,
    arrows: false,
    dots: false,
    autoplay: true,
    infinite: true,
    fade: true,
    speed: 300,
  });

  $product_image_slider_obj.on('afterChange', function (event, slick, currentSlide) {
    updateNavigationDots(currentSlide);
  });

  // Click nav dots -> go to slide
  $(document).on('click', '#product-images--nav .nav-item', function () {
    var slideIndex = $(this).index();
    $product_image_slider_obj.slick('slickGoTo', slideIndex);
  });

  function updateNavigationDots(currentSlide) {
    $('#product-images--nav .nav-item').removeClass('active');
    $('#product-images--nav .nav-item').eq(currentSlide).addClass('active');
  }
</script>

<style>
  .product-image-slider-container {
    position: relative;
    width: 100%;
    max-width: 950px;
    margin: 0 auto;
  }

  #product-images--slider {
    width: 100%;
    cursor: pointer;
  }

  #product-images--slider .item {
    display: flex;
    align-items: center;
    justify-content: center;
    background: #fff;
  }

  #product-images--slider .item img {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: contain;
  }

  .slider-nav {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
    margin-top: 20px;
    padding: 0 20px;
  }

  .nav-item {
    cursor: pointer;
    padding: 5px;
    transition: all 0.3s ease;
  }

  .nav-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: #d9d9d9;
    transition: all 0.3s ease;
  }

  .nav-item.active .nav-dot {
    background-color: #000;
    transform: scale(1.2);
  }

  .nav-item:hover .nav-dot {
    background-color: #666;
    transform: scale(1.1);
  }

  .nav-item.active:hover .nav-dot {
    background-color: #000;
    transform: scale(1.3);
  }

  /* Desktop specific adjustments */
  @media (min-width: 992px) {
    .product-image-slider-container {
      max-width: 800px;
    }

    .slider-nav {
      margin-top: 30px;
      gap: 10px;
    }

    .nav-dot {
      width: 10px;
      height: 10px;
    }
  }

  /* Large desktop adjustments */
  @media (min-width: 1200px) {
    .product-image-slider-container {
      max-width: 950px;
    }
  }

  /* Mobile adjustments */
  @media (max-width: 768px) {
    .slider-nav {
      margin-top: 15px;
      gap: 6px;
    }

    .nav-dot {
      width: 6px;
      height: 6px;
    }
  }
</style>
